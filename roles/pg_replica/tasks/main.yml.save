#- name: "Create a backup directory"
#  file:
#    path: "/var/lib/{{ app_name }}/backups/{{ ansible_date_time }}/"
#    mode: 0777
#    owner: "postgres"
#    state: directory

#- name: "Back up the database"
#  postgresql_db:
#    state: dump
#    name: "{{ db_name }}"
#    target: "/var/lib/{{ app_name }}/backups/{{ now }}/{{ ansible_date_time }}.dump.gz"
#  become: yes
#  become_user: postgres

#- name: "Fetch backup from the server"
#  fetch:
#    src: "/var/lib/{{ app_name }}/backups/{{ ansible_date_time }}/{{ db_name }}.dump.gz"
#    dest: "backups/{{ ansible_date_time }}/{{ db_name }}.dump.gz"
#    flat: yes
